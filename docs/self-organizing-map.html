<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Self-organizing Map | Advanced Geospatial Data Analysis in R: Environmental Applications</title>
  <meta name="description" content="This book will be used for the UNIL Master courses, and also open for the publich who are interested in." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Self-organizing Map | Advanced Geospatial Data Analysis in R: Environmental Applications" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://eugenegis.github.io/AGDAbook/images/UNIL_logo.png" />
  <meta property="og:description" content="This book will be used for the UNIL Master courses, and also open for the publich who are interested in." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Self-organizing Map | Advanced Geospatial Data Analysis in R: Environmental Applications" />
  
  <meta name="twitter:description" content="This book will be used for the UNIL Master courses, and also open for the publich who are interested in." />
  <meta name="twitter:image" content="https://eugenegis.github.io/AGDAbook/images/UNIL_logo.png" />

<meta name="author" content="Marj Tonini, Haokun Liu" />


<meta name="date" content="2024-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="density-based-clustering-algorithm.html"/>
<link rel="next" href="random-forest.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/AGDA_ImageCover.webp"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#author-information"><i class="fa fa-check"></i>Author Information</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-packages"><i class="fa fa-check"></i><b>1.1.1</b> R Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#some-tips"><i class="fa fa-check"></i><b>1.1.2</b> Some tips</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-commands-online-resources"><i class="fa fa-check"></i><b>1.1.3</b> R Commands (online resources)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-markdown"><i class="fa fa-check"></i><b>1.2</b> R Markdown</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-type-in-computational-analysis"><i class="fa fa-check"></i><b>1.3</b> Data type in computational analysis</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.3.1</b> Variables</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structure-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Data structure in R</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frame"><i class="fa fa-check"></i><b>1.3.3</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html"><i class="fa fa-check"></i><b>2</b> Geographically Weighted Summary Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#the-overall-methodology"><i class="fa fa-check"></i><b>2.2</b> The overall methodology</a></li>
<li class="chapter" data-level="2.3" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#forest-fires-dataset"><i class="fa fa-check"></i><b>2.3</b> Forest fires dataset</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#load-the-libraries"><i class="fa fa-check"></i><b>2.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="2.3.2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#import-the-portuguese-forest-fire-dataset"><i class="fa fa-check"></i><b>2.3.2</b> Import the Portuguese forest fire dataset</a></li>
<li class="chapter" data-level="2.3.3" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#forest-fires-spatial-distribution"><i class="fa fa-check"></i><b>2.3.3</b> Forest fires spatial distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#compute-the-geographically-whited-statistics"><i class="fa fa-check"></i><b>2.4</b> Compute the geographically whited statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#look-at-the-results"><i class="fa fa-check"></i><b>2.4.1</b> Look at the results</a></li>
<li class="chapter" data-level="2.4.2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#gwss-maps"><i class="fa fa-check"></i><b>2.4.2</b> GWSS maps</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#conclusions-and-further-analyses"><i class="fa fa-check"></i><b>2.5</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html"><i class="fa fa-check"></i><b>3</b> Kernel Density Estimator</a>
<ul>
<li class="chapter" data-level="3.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#method"><i class="fa fa-check"></i><b>3.2</b> Method</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#ripleys-k-function"><i class="fa fa-check"></i><b>3.2.1</b> Ripley’s K-function</a></li>
<li class="chapter" data-level="3.2.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#kernel-density-estimator-1"><i class="fa fa-check"></i><b>3.2.2</b> Kernel density estimator</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#load-the-libraries-1"><i class="fa fa-check"></i><b>3.3</b> Load the libraries</a></li>
<li class="chapter" data-level="3.4" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#import-the-portuguese-forest-fire-dataset-1"><i class="fa fa-check"></i><b>3.4</b> Import the Portuguese forest fire dataset</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#ff-subsets-based-on-the-burned-areas-size"><i class="fa fa-check"></i><b>3.4.1</b> FF-subsets based on the burned areas’ size</a></li>
<li class="chapter" data-level="3.4.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#ff-subsets-based-on-their-geographical-distribution"><i class="fa fa-check"></i><b>3.4.2</b> FF-subsets based on their geographical distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#the-space-time-k-function"><i class="fa fa-check"></i><b>3.5</b> The space-time K-function</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#extract-time-and-pts-object"><i class="fa fa-check"></i><b>3.5.1</b> Extract Time and PTS object</a></li>
<li class="chapter" data-level="3.5.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#compute-the-space-time-k-function"><i class="fa fa-check"></i><b>3.5.2</b> Compute the space-time K-function</a></li>
<li class="chapter" data-level="3.5.3" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#assess-the-space-time-clustering-behavior"><i class="fa fa-check"></i><b>3.5.3</b> Assess the space-time clustering behavior</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#conclusions-and-further-analyses-1"><i class="fa fa-check"></i><b>3.6</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html"><i class="fa fa-check"></i><b>4</b> Density-based Clustering Algorithm</a>
<ul>
<li class="chapter" data-level="4.1" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#the-overall-methodology-1"><i class="fa fa-check"></i><b>4.2</b> The overall methodology</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#dbscan-3-d-density-based-clustering-algorithm"><i class="fa fa-check"></i><b>4.2.1</b> DBSCAN: 3-D density based clustering algorithm</a></li>
<li class="chapter" data-level="4.2.2" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#field-campaign"><i class="fa fa-check"></i><b>4.2.2</b> Field campaign</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#dbscan-feature-detection-from-points-clouds"><i class="fa fa-check"></i><b>4.3</b> DBSCAN: feature detection from points clouds</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#load-the-libraries-2"><i class="fa fa-check"></i><b>4.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="4.3.2" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#import-and-visualise-the-point-clouds-dataset"><i class="fa fa-check"></i><b>4.3.2</b> Import and visualise the point clouds dataset</a></li>
<li class="chapter" data-level="4.3.3" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#run-dbscan"><i class="fa fa-check"></i><b>4.3.3</b> Run DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#conclusions-and-further-analyses-2"><i class="fa fa-check"></i><b>4.4</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="self-organizing-map.html"><a href="self-organizing-map.html"><i class="fa fa-check"></i><b>5</b> Self-organizing Map</a>
<ul>
<li class="chapter" data-level="5.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#material-and-method"><i class="fa fa-check"></i><b>5.2</b> Material and method</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#the-geo-demographic-context"><i class="fa fa-check"></i><b>5.2.1</b> The geo-demographic context</a></li>
<li class="chapter" data-level="5.2.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#som"><i class="fa fa-check"></i><b>5.2.2</b> SOM</a></li>
<li class="chapter" data-level="5.2.3" data-path="self-organizing-map.html"><a href="self-organizing-map.html#swiss-census-data"><i class="fa fa-check"></i><b>5.2.3</b> Swiss census data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="self-organizing-map.html"><a href="self-organizing-map.html#variables-inspection"><i class="fa fa-check"></i><b>5.3</b> Variables inspection</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#import-the-data"><i class="fa fa-check"></i><b>5.3.1</b> Import the data</a></li>
<li class="chapter" data-level="5.3.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#inspect-the-data"><i class="fa fa-check"></i><b>5.3.2</b> Inspect the data</a></li>
<li class="chapter" data-level="5.3.3" data-path="self-organizing-map.html"><a href="self-organizing-map.html#data-transformation"><i class="fa fa-check"></i><b>5.3.3</b> Data transformation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="self-organizing-map.html"><a href="self-organizing-map.html#running-som"><i class="fa fa-check"></i><b>5.4</b> Running SOM</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#load-the-libraries-3"><i class="fa fa-check"></i><b>5.4.1</b> Load the libraries</a></li>
<li class="chapter" data-level="5.4.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#compute-som"><i class="fa fa-check"></i><b>5.4.2</b> Compute SOM</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="self-organizing-map.html"><a href="self-organizing-map.html#soms-main-outputs"><i class="fa fa-check"></i><b>5.5</b> SOM’s main outputs</a></li>
<li class="chapter" data-level="5.6" data-path="self-organizing-map.html"><a href="self-organizing-map.html#hierarchical-clustering"><i class="fa fa-check"></i><b>5.6</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#clusters-characterization"><i class="fa fa-check"></i><b>5.6.1</b> Clusters characterization</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="self-organizing-map.html"><a href="self-organizing-map.html#conclusions"><i class="fa fa-check"></i><b>5.7</b> Conclusions</a></li>
<li class="chapter" data-level="5.8" data-path="self-organizing-map.html"><a href="self-organizing-map.html#further-analyses"><i class="fa fa-check"></i><b>5.8</b> Further analyses</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>6</b> Random Forest</a>
<ul>
<li class="chapter" data-level="6.1" data-path="random-forest.html"><a href="random-forest.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="random-forest.html"><a href="random-forest.html#the-main-objective"><i class="fa fa-check"></i><b>6.1.1</b> The main objective</a></li>
<li class="chapter" data-level="6.1.2" data-path="random-forest.html"><a href="random-forest.html#load-the-libraries-4"><i class="fa fa-check"></i><b>6.1.2</b> Load the libraries</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="random-forest.html"><a href="random-forest.html#import-the-data-1"><i class="fa fa-check"></i><b>6.2</b> Import the data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="random-forest.html"><a href="random-forest.html#landslides-dataset"><i class="fa fa-check"></i><b>6.2.1</b> Landslides dataset</a></li>
<li class="chapter" data-level="6.2.2" data-path="random-forest.html"><a href="random-forest.html#predictor-variables"><i class="fa fa-check"></i><b>6.2.2</b> Predictor variables</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="random-forest.html"><a href="random-forest.html#create-the-input-dataset"><i class="fa fa-check"></i><b>6.3</b> Create the input dataset</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="random-forest.html"><a href="random-forest.html#split-the-input-dataset-into-training-80-and-testing-20"><i class="fa fa-check"></i><b>6.3.1</b> Split the input dataset into training (80%) and testing (20%)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="random-forest.html"><a href="random-forest.html#run-random-forest"><i class="fa fa-check"></i><b>6.4</b> Run Random Forest</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="random-forest.html"><a href="random-forest.html#rf-main-outputs"><i class="fa fa-check"></i><b>6.4.1</b> RF main outputs</a></li>
<li class="chapter" data-level="6.4.2" data-path="random-forest.html"><a href="random-forest.html#model-evaluation"><i class="fa fa-check"></i><b>6.4.2</b> Model evaluation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="random-forest.html"><a href="random-forest.html#susceptibility-map"><i class="fa fa-check"></i><b>6.5</b> Susceptibility map</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="random-forest.html"><a href="random-forest.html#class-intervals-for-decision-maker"><i class="fa fa-check"></i><b>6.5.1</b> Class intervals for decision maker</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="random-forest.html"><a href="random-forest.html#variable-importance-plot"><i class="fa fa-check"></i><b>6.6</b> Variable importance plot</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="random-forest.html"><a href="random-forest.html#partial-dependence-plot"><i class="fa fa-check"></i><b>6.6.1</b> Partial dependence plot</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="random-forest.html"><a href="random-forest.html#conclusions-and-further-analyses-3"><i class="fa fa-check"></i><b>6.7</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Geospatial Data Analysis in R: Environmental Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="self-organizing-map" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Self-organizing Map<a href="self-organizing-map.html#self-organizing-map" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction<a href="self-organizing-map.html#introduction-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The increasing availability of multivariate datatets stimulates researches to develop new techniques that differ from those utilized in earlier scientific paradigms.
In the field of social and economic science, geo-demographic segmentation defines a technique used to classify a population based on input data describing administrative units and people living there.<span class="citation"><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></span>
Small areas can thus be classified into discrete categories using demographic input data, by means of data reduction techniques (such as the <em>Principal component analysis</em>).
The main limitation of these approaches is the problem of communicating the multidimensional complexity characterizing the different output classes.</p>
<p><strong>Machine learning</strong> techniques can help in this context, as they are designed to extract useful formation and insight from the interaction of the variables describing the complex structure of a given phenomenon.
In the present computing lab we introduce an unsupervised learning procedure based on <em>Self-Organizing Map (SOM)</em>,<span class="citation"><a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></span> allowing detecting clusters and characterizing the pattern of population dynamic in Switzerland in the recent period.
This lab is inspired by the work of <span class="citation">Marj Tonini et al.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></span></p>
</div>
<div id="material-and-method" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Material and method<a href="self-organizing-map.html#material-and-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-geo-demographic-context" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> The geo-demographic context<a href="self-organizing-map.html#the-geo-demographic-context" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Switzerland has the highest life expectancy in the world.
It counts about 8,5 million inhabitants (official census data 2020), twice as much as at the beginning of the 20th century, mainly because of the high level of immigration.
The number of foreigners that currently reside in the country corresponds to about one quarter of the total population.
Most of the population (85%) lives in cities.
Population aging increased over the course of the 20th century, with one in five person of retirement age today.
In the present study, we developed a machine learning based approach to understand and describe the population patterns in different geographic areas.</p>
</div>
<div id="som" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> SOM<a href="self-organizing-map.html#som" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use <strong>SOM</strong>, an <em>unsupervised competitive learning neural network</em> allowing representing a high-dimensional feature space (defined by the multivariate input dataset), as two-dimensional discretized pattern (the SOM grid of neurons).
In SOM the proximity of the units in the output grid reflects the similarity of the corresponding input observations, which guarantees the preservation of the topological structure of the input data.</p>
<p>Compared to other approaches, SOM is very efficient for data visualization.
Indeed it provides additional outputs such as the heatmaps, representing the distribution of each input feature across the SOM grid, extremely useful to visually explore the relationship between the input variables.</p>
</div>
<div id="swiss-census-data" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Swiss census data<a href="self-organizing-map.html#swiss-census-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Input data come from the national population census, provided by the <a href="https://www.bfs.admin.ch/bfs/en/home.html">Swiss Federal Statistical Office</a>, and including information on the socio-economic status of the population and surveyed land use and land cover.
This information has been aggregated to the municipality level for the purpose of the present investigation.
Census data 2020 have been considered to analyse the current pattern, while the former census surveys can be considered to assess transitions and evaluate population dynamics.</p>
</div>
</div>
<div id="variables-inspection" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Variables inspection<a href="self-organizing-map.html#variables-inspection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="import-the-data" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Import the data<a href="self-organizing-map.html#import-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fist, you have to import the Swiss census dataset for the year 2020, referred to the municipality administrative units.
As you can see from the description of the selected variables , some of them can be discarded from the analysis.
So, in the following step, we extract a subset of the most meaningful variables for the purpose of the present study.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="self-organizing-map.html#cb108-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">c</span>(<span class="st">&quot;images/Variables1.jpg&quot;</span>, <span class="st">&quot;images/Variables2.jpg&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:variables-1"></span>
<img src="images/Variables1.jpg" alt="Variables description \label{Variables}" width="100%" height="100%" />
<p class="caption">
Figure 5.1: Variables description
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:variables-2"></span>
<img src="images/Variables2.jpg" alt="Variables description \label{Variables}" width="100%" height="100%" />
<p class="caption">
Figure 5.2: Variables description
</p>
</div>
</div>
<div id="inspect-the-data" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Inspect the data<a href="self-organizing-map.html#inspect-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotting the histogram of the variables distribution allows to detect outliers, see if they have comparable range of values, and evaluate if a data transformation is necessary.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="self-organizing-map.html#cb109-1" tabindex="-1"></a><span class="co"># Plot variables&#39; frequency distribution</span></span>
<span id="cb109-2"><a href="self-organizing-map.html#cb109-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(subset2020)) {      </span>
<span id="cb109-3"><a href="self-organizing-map.html#cb109-3" tabindex="-1"></a>    <span class="fu">hist</span>((subset2020[ , i]),  <span class="at">main=</span><span class="fu">colnames</span>(subset2020[i]))</span>
<span id="cb109-4"><a href="self-organizing-map.html#cb109-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="data-transformation" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Data transformation<a href="self-organizing-map.html#data-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data transformation seeks the make the variables range comparable.
This process ensure the data entries to look similar across all fields and records, making information easier to find, group and analyze.</p>
<p>With <strong>Min-Max Scaling</strong>, the data values are scaled in a range between 0 and 1.
As a consequence, the effect of outliers suppresses to a certain extent.
Moreover, it helps us to have a smaller value of the standard deviation of the data scaled.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="self-organizing-map.html#cb110-1" tabindex="-1"></a><span class="co"># Custom function to implement min max scaling</span></span>
<span id="cb110-2"><a href="self-organizing-map.html#cb110-2" tabindex="-1"></a>minMax <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb110-3"><a href="self-organizing-map.html#cb110-3" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb110-4"><a href="self-organizing-map.html#cb110-4" tabindex="-1"></a>}</span>
<span id="cb110-5"><a href="self-organizing-map.html#cb110-5" tabindex="-1"></a></span>
<span id="cb110-6"><a href="self-organizing-map.html#cb110-6" tabindex="-1"></a><span class="co"># Apply max-min to the data</span></span>
<span id="cb110-7"><a href="self-organizing-map.html#cb110-7" tabindex="-1"></a>dfnorm2020<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lapply</span>((subset2020[ , <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]), minMax))</span>
<span id="cb110-8"><a href="self-organizing-map.html#cb110-8" tabindex="-1"></a><span class="fu">summary</span>(dfnorm2020)</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="self-organizing-map.html#cb111-1" tabindex="-1"></a><span class="co"># Plot the histograms of the transformed data </span></span>
<span id="cb111-2"><a href="self-organizing-map.html#cb111-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dfnorm2020)) {      </span>
<span id="cb111-3"><a href="self-organizing-map.html#cb111-3" tabindex="-1"></a>    <span class="fu">hist</span>((dfnorm2020[ , i]),  <span class="at">main=</span><span class="fu">colnames</span>(dfnorm2020[i]))</span>
<span id="cb111-4"><a href="self-organizing-map.html#cb111-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="running-som" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Running SOM<a href="self-organizing-map.html#running-som" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="load-the-libraries-3" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Load the libraries<a href="self-organizing-map.html#load-the-libraries-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fist you have to load the following libraries:</p>
<ul>
<li><p><strong>kohonen</strong>: Supervised and Unsupervised Self-Organizing Maps (SOM)</p></li>
<li><p><strong>aweSOM:</strong> offers a set of tools to explore and analyze datasets with SOM</p></li>
<li><p><strong>ggplot2</strong>: create Elegant Data Visualizations Using the Grammar of Graphics</p></li>
<li><p><strong>colorpatch</strong>: rendering methods (ggplot extensions)</p></li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="self-organizing-map.html#cb112-1" tabindex="-1"></a><span class="fu">library</span>(kohonen)</span>
<span id="cb112-2"><a href="self-organizing-map.html#cb112-2" tabindex="-1"></a><span class="fu">library</span>(aweSOM)</span>
<span id="cb112-3"><a href="self-organizing-map.html#cb112-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-4"><a href="self-organizing-map.html#cb112-4" tabindex="-1"></a><span class="fu">library</span>(colorpatch)</span>
<span id="cb112-5"><a href="self-organizing-map.html#cb112-5" tabindex="-1"></a>(<span class="fu">.packages</span>())</span></code></pre></div>
</div>
<div id="compute-som" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Compute SOM<a href="self-organizing-map.html#compute-som" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main idea with <strong>SOM</strong> is to map the input high-dimensional feature space in a lower-dimensional output space organized on a grid made up of regular units (i.e. the neurons).
At the end of the process, each observation from the input space (<span class="math inline">\(X_{k,i}\)</span>) will be associated (i.e., mapped) to a unit in the SOM grid.
Depending on the size of the grid, one unit can include several input observations.</p>
<p>The first step consists in defining the size and geometry of the SOM grid.
In this case we define a rectangular grid of 18 by 13 units, allowing to allocate, on average, about 15 input-items per units, and whose geometry reproduces the shape of the study area.
(<strong>NB</strong>: several parameters and configurations of the SOM grid can be implemented and compared, seeking to minimize the <em>Quantization Error, QE</em>)</p>
<p>Finally, you can run the SOM model.
Note that <em>rlen</em> indicates the number of times the complete data set will be presented to the network, while for the other parameters we will keep the default values.</p>
<p>The overall computation include the following steps:</p>
<p><strong>1) The data frame has to be transformed to a matrix</strong></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="self-organizing-map.html#cb113-1" tabindex="-1"></a>mxM2020<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(dfnorm2020) <span class="co"># max-min</span></span></code></pre></div>
<p><strong>2) Create the SOM-grid</strong></p>
<p>Before running SOM, you have to create the grid of output units.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="self-organizing-map.html#cb114-1" tabindex="-1"></a><span class="co"># Gird size 18x13 units</span></span>
<span id="cb114-2"><a href="self-organizing-map.html#cb114-2" tabindex="-1"></a>som_grid <span class="ot">&lt;-</span> <span class="fu">somgrid</span>(<span class="at">xdim =</span> <span class="dv">18</span>, <span class="at">ydim=</span><span class="dv">13</span>) </span></code></pre></div>
<p><strong>3) Run-SOM</strong></p>
<p>The general R function is used for creating simulations of random objects that can be reproduced.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="self-organizing-map.html#cb115-1" tabindex="-1"></a><span class="co"># Use max-min data transformation</span></span>
<span id="cb115-2"><a href="self-organizing-map.html#cb115-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb115-3"><a href="self-organizing-map.html#cb115-3" tabindex="-1"></a></span>
<span id="cb115-4"><a href="self-organizing-map.html#cb115-4" tabindex="-1"></a><span class="co"># Run SOM</span></span>
<span id="cb115-5"><a href="self-organizing-map.html#cb115-5" tabindex="-1"></a>SOM2020M<span class="ot">&lt;-</span> <span class="fu">som</span>(mxM2020,</span>
<span id="cb115-6"><a href="self-organizing-map.html#cb115-6" tabindex="-1"></a>               <span class="at">grid=</span>som_grid, </span>
<span id="cb115-7"><a href="self-organizing-map.html#cb115-7" tabindex="-1"></a>               <span class="at">rlen=</span><span class="dv">1000</span>)</span>
<span id="cb115-8"><a href="self-organizing-map.html#cb115-8" tabindex="-1"></a><span class="fu">print</span>(SOM2020M)</span></code></pre></div>
<pre><code>## SOM of size 18x13 with a rectangular topology.
## Training data included.</code></pre>
<p><strong>4) SOM-model evaluation</strong></p>
<p>Finally, you can optimize the size of the grid by inspecting several quality measure and changing the parameters accordingly.
In particular we will explore the following:</p>
<ul>
<li><p><em>Changes</em>: shows the mean distance to the closest codebook vector during the training.</p></li>
<li><p><em>Quantization error</em>: average squared distance between the data points and the map’s codebook to which they are mapped.
Lower is better.</p></li>
<li><p><em>Percentage of explained variance</em>: similar to other clustering methods, the share of total variance that is explained by the clustering (equal to 1 minus the ratio of quantization error to total variance).
Higher is better.</p></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="self-organizing-map.html#cb117-1" tabindex="-1"></a><span class="co"># Evaluate rlen</span></span>
<span id="cb117-2"><a href="self-organizing-map.html#cb117-2" tabindex="-1"></a><span class="fu">plot</span>(SOM2020M, <span class="at">type=</span><span class="st">&quot;changes&quot;</span>)</span></code></pre></div>
<p><img src="05-SOM_files/figure-html/SOM-quality-1.png" width="672" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="self-organizing-map.html#cb118-1" tabindex="-1"></a><span class="co"># Evaluate the results</span></span>
<span id="cb118-2"><a href="self-organizing-map.html#cb118-2" tabindex="-1"></a>QEM<span class="ot">&lt;-</span><span class="fu">somQuality</span>(SOM2020M, dfnorm2020) </span>
<span id="cb118-3"><a href="self-organizing-map.html#cb118-3" tabindex="-1"></a></span>
<span id="cb118-4"><a href="self-organizing-map.html#cb118-4" tabindex="-1"></a><span class="do">## Quality measures:</span></span>
<span id="cb118-5"><a href="self-organizing-map.html#cb118-5" tabindex="-1"></a>QEM<span class="sc">$</span>err.quant <span class="co"># Quantization error</span></span></code></pre></div>
<pre><code>## [1] 0.04534672</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="self-organizing-map.html#cb120-1" tabindex="-1"></a>QEM<span class="sc">$</span>err.varratio <span class="co"># % explained variance</span></span></code></pre></div>
<pre><code>## [1] 82.06</code></pre>
</div>
</div>
<div id="soms-main-outputs" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> SOM’s main outputs<a href="self-organizing-map.html#soms-main-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The main graphical outputs of SOM are the node counts, the neighborhood distances, and the heatmaps.</p>
<ul>
<li><p><strong>Node counts map</strong> informs about the number of input vectors falling inside each output unit.</p></li>
<li><p><strong>Neighbourhood distance plot</strong> shows the distance between each unit and its neighborhoods.</p></li>
<li><p><strong>Heatmaps</strong> show the distribution of each input variable, associated to each input vectors, across the SOM grid.</p></li>
</ul>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="self-organizing-map.html#cb122-1" tabindex="-1"></a><span class="co"># Create a color palette</span></span>
<span id="cb122-2"><a href="self-organizing-map.html#cb122-2" tabindex="-1"></a>coolBlueHotRed <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">alpha =</span> <span class="dv">1</span>) {<span class="fu">rainbow</span>(n, <span class="at">end=</span><span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>, <span class="at">alpha=</span>alpha)[n<span class="sc">:</span><span class="dv">1</span>]}</span>
<span id="cb122-3"><a href="self-organizing-map.html#cb122-3" tabindex="-1"></a></span>
<span id="cb122-4"><a href="self-organizing-map.html#cb122-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb122-5"><a href="self-organizing-map.html#cb122-5" tabindex="-1"></a></span>
<span id="cb122-6"><a href="self-organizing-map.html#cb122-6" tabindex="-1"></a><span class="co"># Plot node counts map</span></span>
<span id="cb122-7"><a href="self-organizing-map.html#cb122-7" tabindex="-1"></a><span class="fu">plot</span>(SOM2020M, <span class="at">type=</span><span class="st">&quot;count&quot;</span>, <span class="at">main=</span><span class="st">&quot;Node Counts&quot;</span>, <span class="at">palette.name=</span>coolBlueHotRed)</span>
<span id="cb122-8"><a href="self-organizing-map.html#cb122-8" tabindex="-1"></a></span>
<span id="cb122-9"><a href="self-organizing-map.html#cb122-9" tabindex="-1"></a><span class="co"># Plot SOM neighbourhood distance</span></span>
<span id="cb122-10"><a href="self-organizing-map.html#cb122-10" tabindex="-1"></a><span class="fu">plot</span>(SOM2020M, <span class="at">type=</span><span class="st">&quot;dist.neighbours&quot;</span>, <span class="at">main =</span> <span class="st">&quot;SOM neighbour distances&quot;</span>)</span></code></pre></div>
<p><img src="05-SOM_files/figure-html/outputs-SOM-maxmin-1.png" width="672" /></p>
<p>Visualized side by side, heatmaps provide a useful tool to explore the correlation between the input variables .</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="self-organizing-map.html#cb123-1" tabindex="-1"></a><span class="co"># Plot heatmaps for selected variables</span></span>
<span id="cb123-2"><a href="self-organizing-map.html#cb123-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>) </span>
<span id="cb123-3"><a href="self-organizing-map.html#cb123-3" tabindex="-1"></a>  {</span>
<span id="cb123-4"><a href="self-organizing-map.html#cb123-4" tabindex="-1"></a><span class="fu">plot</span>(SOM2020M, <span class="at">type =</span> <span class="st">&quot;property&quot;</span>, <span class="at">property =</span> <span class="fu">getCodes</span>(SOM2020M)[,i],</span>
<span id="cb123-5"><a href="self-organizing-map.html#cb123-5" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">colnames</span>(<span class="fu">getCodes</span>(SOM2020M))[i], <span class="at">palette.name=</span>coolBlueHotRed)</span>
<span id="cb123-6"><a href="self-organizing-map.html#cb123-6" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="self-organizing-map.html#cb124-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/Heatmaps.jpg&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:jpg1"></span>
<img src="images/Heatmaps.jpg" alt="Heatmaps \label{Heatmaps}" width="70%" height="70%" />
<p class="caption">
Figure 5.3: Heatmaps
</p>
</div>
</div>
<div id="hierarchical-clustering" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Hierarchical clustering<a href="self-organizing-map.html#hierarchical-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hierarchical clustering can finally be performed to isolate groups of input vectors characterized by a similar distribution of the input variables.
This second step takes the SOM-units (i.e., the CodeBook vectors) as input and group them into the desired number of clusters (we choose 7 in this case).
This allows to characterize main typologies of geo-demographic groups.</p>
<ul>
<li><strong>Apply hierarchical clustering:</strong></li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="self-organizing-map.html#cb125-1" tabindex="-1"></a>CB2020M <span class="ot">&lt;-</span> <span class="fu">getCodes</span>(SOM2020M) <span class="co"># Extract codebook vectors</span></span>
<span id="cb125-2"><a href="self-organizing-map.html#cb125-2" tabindex="-1"></a></span>
<span id="cb125-3"><a href="self-organizing-map.html#cb125-3" tabindex="-1"></a>cls2020M <span class="ot">&lt;-</span> <span class="fu">cutree</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(CB2020M)), <span class="dv">7</span>)</span></code></pre></div>
<ul>
<li><strong>Display the SOM-grid with different colors for each cluster:</strong></li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="self-organizing-map.html#cb126-1" tabindex="-1"></a><span class="co"># Colour palette definition, will use later too.</span></span>
<span id="cb126-2"><a href="self-organizing-map.html#cb126-2" tabindex="-1"></a><span class="co"># If you change the number of hierarchical clustering, remember change the number of color.</span></span>
<span id="cb126-3"><a href="self-organizing-map.html#cb126-3" tabindex="-1"></a></span>
<span id="cb126-4"><a href="self-organizing-map.html#cb126-4" tabindex="-1"></a>map_palette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;steelblue3&quot;</span>,<span class="st">&quot;darkgoldenrod4&quot;</span>,<span class="st">&quot;darkolivegreen&quot;</span>, <span class="st">&quot;springgreen3&quot;</span>, <span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;firebrick&quot;</span>, <span class="st">&quot;darkolivegreen1&quot;</span> )</span>
<span id="cb126-5"><a href="self-organizing-map.html#cb126-5" tabindex="-1"></a></span>
<span id="cb126-6"><a href="self-organizing-map.html#cb126-6" tabindex="-1"></a><span class="fu">plot</span>(SOM2020M, <span class="at">type=</span><span class="st">&quot;mapping&quot;</span>, <span class="at">pchs=</span><span class="st">&quot;&quot;</span>, <span class="at">bgcol =</span> map_palette[cls2020M], <span class="at">main =</span> <span class="st">&quot;Clusters&quot;</span>)</span></code></pre></div>
<p><img src="05-SOM_files/figure-html/clustermap_maxmin-1.png" width="672" /></p>
<ul>
<li><strong>Assign the cluster number (based on hierarchical clustering) to each unit:</strong></li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="self-organizing-map.html#cb127-1" tabindex="-1"></a>clasgn <span class="ot">&lt;-</span> cls2020M[SOM2020M<span class="sc">$</span>unit.classif]</span>
<span id="cb127-2"><a href="self-organizing-map.html#cb127-2" tabindex="-1"></a>dfnorm2020<span class="sc">$</span>hc<span class="ot">&lt;-</span>clasgn</span>
<span id="cb127-3"><a href="self-organizing-map.html#cb127-3" tabindex="-1"></a>clsnorm<span class="ot">&lt;-</span><span class="fu">cbind</span>(dfnorm2020, subset2020<span class="sc">$</span>BFS_nummer)</span>
<span id="cb127-4"><a href="self-organizing-map.html#cb127-4" tabindex="-1"></a></span>
<span id="cb127-5"><a href="self-organizing-map.html#cb127-5" tabindex="-1"></a><span class="co"># Export the table with clusters </span></span>
<span id="cb127-6"><a href="self-organizing-map.html#cb127-6" tabindex="-1"></a><span class="fu">write.table</span>(clsnorm, <span class="at">file=</span><span class="st">&quot;hcM_7cls.csv&quot;</span>, <span class="at">sep=</span><span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<ul>
<li><strong>Map the resulting clusters to the geographical space</strong></li>
</ul>
<p>You can import the final table with the values of the population census variable in a GIS and join the values to the administrative limits at municipality levels in Switzerland.
This allows you to elaborate a map as in .</p>
<p><strong>NB</strong>. You need only two columns: the code identifying each municipality (“BFS_nummer”) and the cluster number (hc).
Open the table including the resulting clusters with a dedicated program (like Excel) to reorganize the header, as a new column for unique identifier has been created automatically (you can name it “ID”), and headers has to be shifted of one place on the right.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:jpg2"></span>
<img src="images/Clusters_7.jpg" alt="Spatial pattern distribution of Swiss poputaion census \label{Clusters_7}" width="70%" height="70%" />
<p class="caption">
Figure 5.4: Spatial pattern distribution of Swiss poputaion census
</p>
</div>
<p>If you want to try the primary and automatic process in Rstudio, you can conduct the below codes and see the map.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="self-organizing-map.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(st)</span>
<span id="cb128-2"><a href="self-organizing-map.html#cb128-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb128-3"><a href="self-organizing-map.html#cb128-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-4"><a href="self-organizing-map.html#cb128-4" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb128-5"><a href="self-organizing-map.html#cb128-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="self-organizing-map.html#cb129-1" tabindex="-1"></a><span class="co"># Load the shapefile data</span></span>
<span id="cb129-2"><a href="self-organizing-map.html#cb129-2" tabindex="-1"></a>CH_outline <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/Lab04/Municiplities.shp&quot;</span>)</span>
<span id="cb129-3"><a href="self-organizing-map.html#cb129-3" tabindex="-1"></a></span>
<span id="cb129-4"><a href="self-organizing-map.html#cb129-4" tabindex="-1"></a><span class="co"># Quick check the shapefile data</span></span>
<span id="cb129-5"><a href="self-organizing-map.html#cb129-5" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb129-6"><a href="self-organizing-map.html#cb129-6" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> CH_outline, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;cyan1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb129-7"><a href="self-organizing-map.html#cb129-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Swiss municiplities&quot;</span>) <span class="sc">+</span> </span>
<span id="cb129-8"><a href="self-organizing-map.html#cb129-8" tabindex="-1"></a>  <span class="fu">coord_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="self-organizing-map.html#cb130-1" tabindex="-1"></a><span class="co"># Rename the column</span></span>
<span id="cb130-2"><a href="self-organizing-map.html#cb130-2" tabindex="-1"></a><span class="fu">colnames</span>(clsnorm)[<span class="dv">20</span>] <span class="ot">&lt;-</span> <span class="st">&quot;BFS_NUMMER&quot;</span></span>
<span id="cb130-3"><a href="self-organizing-map.html#cb130-3" tabindex="-1"></a></span>
<span id="cb130-4"><a href="self-organizing-map.html#cb130-4" tabindex="-1"></a><span class="co"># Merge the dataframe and shapefile together by the column with the same name</span></span>
<span id="cb130-5"><a href="self-organizing-map.html#cb130-5" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">merge</span>(CH_outline, clsnorm, <span class="at">by =</span> <span class="st">&quot;BFS_NUMMER&quot;</span>)</span>
<span id="cb130-6"><a href="self-organizing-map.html#cb130-6" tabindex="-1"></a></span>
<span id="cb130-7"><a href="self-organizing-map.html#cb130-7" tabindex="-1"></a><span class="co"># Rename the column with clustering results</span></span>
<span id="cb130-8"><a href="self-organizing-map.html#cb130-8" tabindex="-1"></a>z<span class="sc">$</span>cluster <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(z<span class="sc">$</span>hc)</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="self-organizing-map.html#cb131-1" tabindex="-1"></a><span class="co"># Mapping the clusters via ggplot like QGIS/ArcGIS Pro/Arcmap, similar package &#39;tmap&#39;</span></span>
<span id="cb131-2"><a href="self-organizing-map.html#cb131-2" tabindex="-1"></a>CH_cluster <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> z) <span class="sc">+</span> <span class="co"># Original data</span></span>
<span id="cb131-3"><a href="self-organizing-map.html#cb131-3" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">as.factor</span>(cluster))) <span class="sc">+</span> <span class="co"># Mapping the clusters</span></span>
<span id="cb131-4"><a href="self-organizing-map.html#cb131-4" tabindex="-1"></a>    <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="at">width_hint =</span> <span class="fl">0.3</span>,</span>
<span id="cb131-5"><a href="self-organizing-map.html#cb131-5" tabindex="-1"></a>                     <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span> <span class="co"># Mapping scales, which are calculated by project coordinates</span></span>
<span id="cb131-6"><a href="self-organizing-map.html#cb131-6" tabindex="-1"></a>    <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="at">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb131-7"><a href="self-organizing-map.html#cb131-7" tabindex="-1"></a>          <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">0.0</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb131-8"><a href="self-organizing-map.html#cb131-8" tabindex="-1"></a>          <span class="at">style =</span> north_arrow_fancy_orienteering) <span class="sc">+</span> <span class="co"># Mapping north arrow</span></span>
<span id="cb131-9"><a href="self-organizing-map.html#cb131-9" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> map_palette) <span class="sc">+</span> <span class="co"># Set up the our color palette</span></span>
<span id="cb131-10"><a href="self-organizing-map.html#cb131-10" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># Background color, if use, it means without color</span></span>
<span id="cb131-11"><a href="self-organizing-map.html#cb131-11" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Spatial pattern distribution of Swiss poputaion census&quot;</span>) <span class="sc">+</span> <span class="co"># Insert title of the map</span></span>
<span id="cb131-12"><a href="self-organizing-map.html#cb131-12" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Clusters&quot;</span>, </span>
<span id="cb131-13"><a href="self-organizing-map.html#cb131-13" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1: Unproductive&quot;</span>, <span class="st">&quot;2: Forest/Peri-urban&quot;</span>, <span class="st">&quot;3: Peri-urban/Rural&quot;</span>,</span>
<span id="cb131-14"><a href="self-organizing-map.html#cb131-14" tabindex="-1"></a>                                 <span class="st">&quot;4: Rural&quot;</span>,<span class="st">&quot;5: Suburban&quot;</span>,<span class="st">&quot;6: Urban centre&quot;</span>,<span class="st">&quot;7: Peri-urban fringe&quot;</span>)) <span class="co"># Legend labels</span></span>
<span id="cb131-15"><a href="self-organizing-map.html#cb131-15" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Clusters&quot;</span>)) <span class="co"># Legend name</span></span>
<span id="cb131-16"><a href="self-organizing-map.html#cb131-16" tabindex="-1"></a></span>
<span id="cb131-17"><a href="self-organizing-map.html#cb131-17" tabindex="-1"></a><span class="co"># Save the map as jpg</span></span>
<span id="cb131-18"><a href="self-organizing-map.html#cb131-18" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;CH_cluster.jpg&quot;</span>)</span>
<span id="cb131-19"><a href="self-organizing-map.html#cb131-19" tabindex="-1"></a>    </span>
<span id="cb131-20"><a href="self-organizing-map.html#cb131-20" tabindex="-1"></a>CH_cluster</span></code></pre></div>
<p><img src="05-SOM_files/figure-html/mapping%20the%20clusters-1.png" width="672" /></p>
<div id="clusters-characterization" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Clusters characterization<a href="self-organizing-map.html#clusters-characterization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To interpret the final main clusters in therms of their geo-demographic characteristics, you can evaluate the distribution of each variable within the clusters by using <strong>box plots</strong> (also known as <em>whisker plot</em>).</p>
<p>Box-plot is a standardized way to display a dataset based on the five-number summary statistics: the minimum, the maximum, the sample median, and the first and third quartiles (i.e., the median of the lower half (25%) and the median of the upper half (75%) of the dataset).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="self-organizing-map.html#cb132-1" tabindex="-1"></a><span class="co"># Creates an empty list object that will be filled by the loop</span></span>
<span id="cb132-2"><a href="self-organizing-map.html#cb132-2" tabindex="-1"></a>cls20M <span class="ot">&lt;-</span> <span class="fu">list</span>() </span>
<span id="cb132-3"><a href="self-organizing-map.html#cb132-3" tabindex="-1"></a></span>
<span id="cb132-4"><a href="self-organizing-map.html#cb132-4" tabindex="-1"></a><span class="co"># Split the single clusters</span></span>
<span id="cb132-5"><a href="self-organizing-map.html#cb132-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb132-6"><a href="self-organizing-map.html#cb132-6" tabindex="-1"></a>  cls20M[[i]]<span class="ot">&lt;-</span><span class="fu">subset</span>(clsnorm, clsnorm<span class="sc">$</span>hc<span class="sc">==</span>i) </span>
<span id="cb132-7"><a href="self-organizing-map.html#cb132-7" tabindex="-1"></a>}</span>
<span id="cb132-8"><a href="self-organizing-map.html#cb132-8" tabindex="-1"></a></span>
<span id="cb132-9"><a href="self-organizing-map.html#cb132-9" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>)) </span>
<span id="cb132-10"><a href="self-organizing-map.html#cb132-10" tabindex="-1"></a></span>
<span id="cb132-11"><a href="self-organizing-map.html#cb132-11" tabindex="-1"></a><span class="co"># Box-plots for the single clusters</span></span>
<span id="cb132-12"><a href="self-organizing-map.html#cb132-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.5</span>,  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<p>To better investigate the values assumed by each class of variables withing the different clusters, you can group them by category.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="self-organizing-map.html#cb133-1" tabindex="-1"></a><span class="co"># Box plot by categories: &quot;Physical space&quot;</span></span>
<span id="cb133-2"><a href="self-organizing-map.html#cb133-2" tabindex="-1"></a></span>
<span id="cb133-3"><a href="self-organizing-map.html#cb133-3" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) </span>
<span id="cb133-4"><a href="self-organizing-map.html#cb133-4" tabindex="-1"></a></span>
<span id="cb133-5"><a href="self-organizing-map.html#cb133-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb133-6"><a href="self-organizing-map.html#cb133-6" tabindex="-1"></a></span>
<span id="cb133-7"><a href="self-organizing-map.html#cb133-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i),  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:boxplot-clsM-PhisicalSpace"></span>
<img src="05-SOM_files/figure-html/boxplot-clsM-PhisicalSpace-1.png" alt="Physical space" width="672" />
<p class="caption">
Figure 5.5: Physical space
</p>
</div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="self-organizing-map.html#cb134-1" tabindex="-1"></a><span class="co"># Box plot by categories: &quot;Demographics&quot;</span></span>
<span id="cb134-2"><a href="self-organizing-map.html#cb134-2" tabindex="-1"></a></span>
<span id="cb134-3"><a href="self-organizing-map.html#cb134-3" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">13</span>)) </span>
<span id="cb134-4"><a href="self-organizing-map.html#cb134-4" tabindex="-1"></a></span>
<span id="cb134-5"><a href="self-organizing-map.html#cb134-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb134-6"><a href="self-organizing-map.html#cb134-6" tabindex="-1"></a></span>
<span id="cb134-7"><a href="self-organizing-map.html#cb134-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i),  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:boxplot-clsM-Deographic"></span>
<img src="05-SOM_files/figure-html/boxplot-clsM-Deographic-1.png" alt="Demographics" width="672" />
<p class="caption">
Figure 5.6: Demographics
</p>
</div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="self-organizing-map.html#cb135-1" tabindex="-1"></a><span class="co"># Box plot by categories: &quot;Socio-economics&quot;</span></span>
<span id="cb135-2"><a href="self-organizing-map.html#cb135-2" tabindex="-1"></a></span>
<span id="cb135-3"><a href="self-organizing-map.html#cb135-3" tabindex="-1"></a>clsvar20M <span class="ot">&lt;-</span> <span class="fu">lapply</span>(cls20M, <span class="st">&quot;[&quot;</span>, <span class="fu">c</span>(<span class="dv">14</span><span class="sc">:</span><span class="dv">18</span>)) </span>
<span id="cb135-4"><a href="self-organizing-map.html#cb135-4" tabindex="-1"></a></span>
<span id="cb135-5"><a href="self-organizing-map.html#cb135-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">cex.axis=</span><span class="fl">0.7</span>)</span>
<span id="cb135-6"><a href="self-organizing-map.html#cb135-6" tabindex="-1"></a></span>
<span id="cb135-7"><a href="self-organizing-map.html#cb135-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {<span class="fu">boxplot</span> ((clsvar20M[[i]]), <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i),  <span class="at">las=</span><span class="dv">2</span>)}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:boxplot-clsM-SocioEconomic"></span>
<img src="05-SOM_files/figure-html/boxplot-clsM-SocioEconomic-1.png" alt="Socio-economics" width="672" />
<p class="caption">
Figure 5.7: Socio-economics
</p>
</div>
</div>
</div>
<div id="conclusions" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Conclusions<a href="self-organizing-map.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Results of the present study reveal the main patterns of the population in Switzerland based on the surveyed land-use, socio-economic, and demographic indicators.
To characterize the final main clusters, the distribution of each variable within them have been assessed by using <strong>box plots</strong>.
We could thus identify main clusters including the most developed and active cities with higher income, the peri-urban areas mostly devoted to the agricultural activity, or the areas with higher levels of migration.</p>
<p><strong>SOM heatmaps</strong> allow to display the pattern distribution of each input variable over the SOM-grid and how values change in space.
Visualized side by side, heatmaps show a picture of the different areas and their characteristics.
In this way it is possible to explore the level of complementarity that links one or more variables among them.</p>
<p>In conclusion, in the present study we proposed a performant data-driven approach based on unsupervised learning allowing to extract useful information from a huge volume of multivariate population census data.
This approach led to represent and interpret the main patterns characterizing the dynamic of population in Switzerland in the recent period.</p>
</div>
<div id="further-analyses" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Further analyses<a href="self-organizing-map.html#further-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be sure that everything is perfectly clear for you, we propose you to <strong>answer the following questions</strong> and to discuss your answers with the other participants to the course or directly with the teacher.</p>
<ol style="list-style-type: decimal">
<li>Change the size of the gridmap and check if you get better results for SOM. <strong>N.B.</strong> Better results are achieved when the quantisation error decreases, the explained variance increases, and there are no empty observations revealed by the Node Counts map.</li>
</ol>
<p>2.1) Focusing on Cluster 6: which variable characterize it the most?
Based on these variables, which class of land use can be associated to this cluster?
2.2) And in the case of Cluster 4?</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Describe the distribution of the clusters in the geographical space.
In more details, describe to which kind of land use the different clusters can be referred and specify why.</p></li>
<li><p>From the visual inspection of the heatmaps, describe the correlation you can observe between the following variables: a) “p_transport” and “p_infrastructure”; b) “p_agriculture” and “p_improductible”.</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-kohonen_self-organized_1982" class="csl-entry">
Kohonen, Teuvo. <span>“Self-Organized Formation of Topologically Correct Feature Maps.”</span> <em>Biological Cybernetics</em> 43, no. 1 (January 1, 1982): 59–69. <a href="https://doi.org/10.1007/BF00337288">https://doi.org/10.1007/BF00337288</a>.
</div>
<div id="ref-marj_tonini_unsupervised_2023" class="csl-entry">
Marj Tonini, Axelle Bersier, Jingyan Yu, and Francois Bavaud. <span>“An Unsupervised Learning Approach to Explore Geodemographic Clusters in Switzerland.”</span> In <em><span>ECTQG</span> 2023 Proceedings</em>. Braga, Portugal, 2023. <a href="https://ucpages.uc.pt/site/assets/files/1249198/ectqg_2023_proceedings_final.pdf">https://ucpages.uc.pt/site/assets/files/1249198/ectqg_2023_proceedings_final.pdf</a>.
</div>
<div id="ref-spielman_social_2008" class="csl-entry">
Spielman, Seth E., and Jean-Claude Thill. <span>“Social Area Analysis, Data Mining, and <span>GIS</span>.”</span> <em>Computers, Environment and Urban Systems</em> 32, no. 2 (March 1, 2008): 110–22. <a href="https://doi.org/10.1016/j.compenvurbsys.2007.11.004">https://doi.org/10.1016/j.compenvurbsys.2007.11.004</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>See <a href="#ref-spielman_social_2008">Seth E. Spielman and Jean-Claude Thill, <span>“Social Area Analysis, Data Mining, and <span>GIS</span>,”</span> <em>Computers, Environment and Urban Systems</em> 32, no. 2 (March 1, 2008): 110–22, <span>https://doi.org/10.1016/j.compenvurbsys.2007.11.004</span></a>.<a href="self-organizing-map.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>See <a href="#ref-kohonen_self-organized_1982">Teuvo Kohonen, <span>“Self-Organized Formation of Topologically Correct Feature Maps,”</span> <em>Biological Cybernetics</em> 43, no. 1 (January 1, 1982): 59–69, <span>https://doi.org/10.1007/BF00337288</span></a>.<a href="self-organizing-map.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p><a href="#ref-marj_tonini_unsupervised_2023"><span>“An Unsupervised Learning Approach to Explore Geodemographic Clusters in Switzerland,”</span> in <em><span>ECTQG</span> 2023 Proceedings</em> (23rd european colloquium on theoretical and quantitative geography, Braga, Portugal, 2023), <span>https://ucpages.uc.pt/site/assets/files/1249198/ectqg_2023_proceedings_final.pdf</span></a>.<a href="self-organizing-map.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="density-based-clustering-algorithm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="random-forest.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/EugeneGIS/AGDAbook/edit/master05-SOM.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fake-book.pdf", "fake-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
