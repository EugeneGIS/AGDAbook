<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Kernel Density Estimator | Advanced Geospatial Data Analysis in R: Environmental Applications</title>
  <meta name="description" content="This book will be used for the UNIL Master courses, and also open for the publich who are interested in." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Kernel Density Estimator | Advanced Geospatial Data Analysis in R: Environmental Applications" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://eugenegis.github.io/AGDAbook/images/UNIL_logo.png" />
  <meta property="og:description" content="This book will be used for the UNIL Master courses, and also open for the publich who are interested in." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Kernel Density Estimator | Advanced Geospatial Data Analysis in R: Environmental Applications" />
  
  <meta name="twitter:description" content="This book will be used for the UNIL Master courses, and also open for the publich who are interested in." />
  <meta name="twitter:image" content="https://eugenegis.github.io/AGDAbook/images/UNIL_logo.png" />

<meta name="author" content="Marj Tonini, Haokun Liu" />


<meta name="date" content="2024-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="geographically-weighted-summary-statistics.html"/>
<link rel="next" href="density-based-clustering-algorithm.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Geospatial Data Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#author-information"><i class="fa fa-check"></i>Author Information</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R Language</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-packages"><i class="fa fa-check"></i><b>1.1.1</b> R Packages</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#some-tips"><i class="fa fa-check"></i><b>1.1.2</b> Some tips</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-commands-online-resources"><i class="fa fa-check"></i><b>1.1.3</b> R Commands (online resources)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#r-markdown"><i class="fa fa-check"></i><b>1.2</b> R Markdown</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-type-in-computational-analysis"><i class="fa fa-check"></i><b>1.3</b> Data type in computational analysis</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.3.1</b> Variables</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structure-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Data structure in R</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frame"><i class="fa fa-check"></i><b>1.3.3</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html"><i class="fa fa-check"></i><b>2</b> Geographically Weighted Summary Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#the-overall-methodology"><i class="fa fa-check"></i><b>2.2</b> The overall methodology</a></li>
<li class="chapter" data-level="2.3" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#forest-fires-dataset"><i class="fa fa-check"></i><b>2.3</b> Forest fires dataset</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#load-the-libraries"><i class="fa fa-check"></i><b>2.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="2.3.2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#import-the-portuguese-forest-fire-dataset"><i class="fa fa-check"></i><b>2.3.2</b> Import the Portuguese forest fire dataset</a></li>
<li class="chapter" data-level="2.3.3" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#forest-fires-spatial-distribution"><i class="fa fa-check"></i><b>2.3.3</b> Forest fires spatial distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#compute-the-geographically-whited-statistics"><i class="fa fa-check"></i><b>2.4</b> Compute the geographically whited statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#look-at-the-results"><i class="fa fa-check"></i><b>2.4.1</b> Look at the results</a></li>
<li class="chapter" data-level="2.4.2" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#gwss-maps"><i class="fa fa-check"></i><b>2.4.2</b> GWSS maps</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="geographically-weighted-summary-statistics.html"><a href="geographically-weighted-summary-statistics.html#conclusions-and-further-analyses"><i class="fa fa-check"></i><b>2.5</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html"><i class="fa fa-check"></i><b>3</b> Kernel Density Estimator</a>
<ul>
<li class="chapter" data-level="3.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#method"><i class="fa fa-check"></i><b>3.2</b> Method</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#ripleys-k-function"><i class="fa fa-check"></i><b>3.2.1</b> Ripley’s K-function</a></li>
<li class="chapter" data-level="3.2.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#kernel-density-estimator-1"><i class="fa fa-check"></i><b>3.2.2</b> Kernel density estimator</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#load-the-libraries-1"><i class="fa fa-check"></i><b>3.3</b> Load the libraries</a></li>
<li class="chapter" data-level="3.4" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#import-the-portuguese-forest-fire-dataset-1"><i class="fa fa-check"></i><b>3.4</b> Import the Portuguese forest fire dataset</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#ff-subsets-based-on-the-burned-areas-size"><i class="fa fa-check"></i><b>3.4.1</b> FF-subsets based on the burned areas’ size</a></li>
<li class="chapter" data-level="3.4.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#ff-subsets-based-on-their-geographical-distribution"><i class="fa fa-check"></i><b>3.4.2</b> FF-subsets based on their geographical distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#the-space-time-k-function"><i class="fa fa-check"></i><b>3.5</b> The space-time K-function</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#extract-time-and-pts-object"><i class="fa fa-check"></i><b>3.5.1</b> Extract Time and PTS object</a></li>
<li class="chapter" data-level="3.5.2" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#compute-the-space-time-k-function"><i class="fa fa-check"></i><b>3.5.2</b> Compute the space-time K-function</a></li>
<li class="chapter" data-level="3.5.3" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#assess-the-space-time-clustering-behavior"><i class="fa fa-check"></i><b>3.5.3</b> Assess the space-time clustering behavior</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="kernel-density-estimator.html"><a href="kernel-density-estimator.html#conclusions-and-further-analyses-1"><i class="fa fa-check"></i><b>3.6</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html"><i class="fa fa-check"></i><b>4</b> Density-based Clustering Algorithm</a>
<ul>
<li class="chapter" data-level="4.1" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#the-overall-methodology-1"><i class="fa fa-check"></i><b>4.2</b> The overall methodology</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#dbscan-3-d-density-based-clustering-algorithm"><i class="fa fa-check"></i><b>4.2.1</b> DBSCAN: 3-D density based clustering algorithm</a></li>
<li class="chapter" data-level="4.2.2" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#field-campaign"><i class="fa fa-check"></i><b>4.2.2</b> Field campaign</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#dbscan-feature-detection-from-points-clouds"><i class="fa fa-check"></i><b>4.3</b> DBSCAN: feature detection from points clouds</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#load-the-libraries-2"><i class="fa fa-check"></i><b>4.3.1</b> Load the libraries</a></li>
<li class="chapter" data-level="4.3.2" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#import-and-visualise-the-point-clouds-dataset"><i class="fa fa-check"></i><b>4.3.2</b> Import and visualise the point clouds dataset</a></li>
<li class="chapter" data-level="4.3.3" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#run-dbscan"><i class="fa fa-check"></i><b>4.3.3</b> Run DBSCAN</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="density-based-clustering-algorithm.html"><a href="density-based-clustering-algorithm.html#conclusions-and-further-analyses-2"><i class="fa fa-check"></i><b>4.4</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="self-organizing-map.html"><a href="self-organizing-map.html"><i class="fa fa-check"></i><b>5</b> Self-organizing Map</a>
<ul>
<li class="chapter" data-level="5.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#material-and-method"><i class="fa fa-check"></i><b>5.2</b> Material and method</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#the-geo-demographic-context"><i class="fa fa-check"></i><b>5.2.1</b> The geo-demographic context</a></li>
<li class="chapter" data-level="5.2.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#som"><i class="fa fa-check"></i><b>5.2.2</b> SOM</a></li>
<li class="chapter" data-level="5.2.3" data-path="self-organizing-map.html"><a href="self-organizing-map.html#swiss-census-data"><i class="fa fa-check"></i><b>5.2.3</b> Swiss census data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="self-organizing-map.html"><a href="self-organizing-map.html#variables-inspection"><i class="fa fa-check"></i><b>5.3</b> Variables inspection</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#import-the-data"><i class="fa fa-check"></i><b>5.3.1</b> Import the data</a></li>
<li class="chapter" data-level="5.3.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#inspect-the-data"><i class="fa fa-check"></i><b>5.3.2</b> Inspect the data</a></li>
<li class="chapter" data-level="5.3.3" data-path="self-organizing-map.html"><a href="self-organizing-map.html#data-transformation"><i class="fa fa-check"></i><b>5.3.3</b> Data transformation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="self-organizing-map.html"><a href="self-organizing-map.html#running-som"><i class="fa fa-check"></i><b>5.4</b> Running SOM</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#load-the-libraries-3"><i class="fa fa-check"></i><b>5.4.1</b> Load the libraries</a></li>
<li class="chapter" data-level="5.4.2" data-path="self-organizing-map.html"><a href="self-organizing-map.html#compute-som"><i class="fa fa-check"></i><b>5.4.2</b> Compute SOM</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="self-organizing-map.html"><a href="self-organizing-map.html#soms-main-outputs"><i class="fa fa-check"></i><b>5.5</b> SOM’s main outputs</a></li>
<li class="chapter" data-level="5.6" data-path="self-organizing-map.html"><a href="self-organizing-map.html#hierarchical-clustering"><i class="fa fa-check"></i><b>5.6</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="self-organizing-map.html"><a href="self-organizing-map.html#clusters-characterization"><i class="fa fa-check"></i><b>5.6.1</b> Clusters characterization</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="self-organizing-map.html"><a href="self-organizing-map.html#conclusions"><i class="fa fa-check"></i><b>5.7</b> Conclusions</a></li>
<li class="chapter" data-level="5.8" data-path="self-organizing-map.html"><a href="self-organizing-map.html#further-analyses"><i class="fa fa-check"></i><b>5.8</b> Further analyses</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="random-forest.html"><a href="random-forest.html"><i class="fa fa-check"></i><b>6</b> Random Forest</a>
<ul>
<li class="chapter" data-level="6.1" data-path="random-forest.html"><a href="random-forest.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="random-forest.html"><a href="random-forest.html#the-main-objective"><i class="fa fa-check"></i><b>6.1.1</b> The main objective</a></li>
<li class="chapter" data-level="6.1.2" data-path="random-forest.html"><a href="random-forest.html#load-the-libraries-4"><i class="fa fa-check"></i><b>6.1.2</b> Load the libraries</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="random-forest.html"><a href="random-forest.html#import-the-data-1"><i class="fa fa-check"></i><b>6.2</b> Import the data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="random-forest.html"><a href="random-forest.html#landslides-dataset"><i class="fa fa-check"></i><b>6.2.1</b> Landslides dataset</a></li>
<li class="chapter" data-level="6.2.2" data-path="random-forest.html"><a href="random-forest.html#predictor-variables"><i class="fa fa-check"></i><b>6.2.2</b> Predictor variables</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="random-forest.html"><a href="random-forest.html#create-the-input-dataset"><i class="fa fa-check"></i><b>6.3</b> Create the input dataset</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="random-forest.html"><a href="random-forest.html#split-the-input-dataset-into-training-80-and-testing-20"><i class="fa fa-check"></i><b>6.3.1</b> Split the input dataset into training (80%) and testing (20%)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="random-forest.html"><a href="random-forest.html#run-random-forest"><i class="fa fa-check"></i><b>6.4</b> Run Random Forest</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="random-forest.html"><a href="random-forest.html#rf-main-outputs"><i class="fa fa-check"></i><b>6.4.1</b> RF main outputs</a></li>
<li class="chapter" data-level="6.4.2" data-path="random-forest.html"><a href="random-forest.html#model-evaluation"><i class="fa fa-check"></i><b>6.4.2</b> Model evaluation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="random-forest.html"><a href="random-forest.html#susceptibility-map"><i class="fa fa-check"></i><b>6.5</b> Susceptibility map</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="random-forest.html"><a href="random-forest.html#class-intervals-for-decision-maker"><i class="fa fa-check"></i><b>6.5.1</b> Class intervals for decision maker</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="random-forest.html"><a href="random-forest.html#variable-importance-plot"><i class="fa fa-check"></i><b>6.6</b> Variable importance plot</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="random-forest.html"><a href="random-forest.html#partial-dependence-plot"><i class="fa fa-check"></i><b>6.6.1</b> Partial dependence plot</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="random-forest.html"><a href="random-forest.html#conclusions-and-further-analyses-3"><i class="fa fa-check"></i><b>6.7</b> Conclusions and further analyses</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Geospatial Data Analysis in R: Environmental Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="kernel-density-estimator" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Kernel Density Estimator<a href="kernel-density-estimator.html#kernel-density-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction<a href="kernel-density-estimator.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The configuration of forest fires across space and time presents a complex pattern which significantly affects the forest environment and adjacent human developments.
Statistical techniques designed for spatio-temporal random points can be utilized to identify a structure, recognize hot-spots and vulnerable areas, and address policy makers to prevention and forecasting measures.</p>
<p>In this practical computer lab we consider the same case study as in the “Geographically Weighted Summary Statistics” lab.
The main objective is to reveal if space and time act independently or whether neighboring events are also closer in time, interacting to generate spatio-temporal clusters.
The attribute that we will consider to achieve this goal is the starting date of fires events.
To account for the different geographical distribution of fires in Portugal, evets occurred in the Norther and Southern area will be modeled separately.</p>
<p>For more details about the input dataset, please refer to the GWSS lab documentation.</p>
</div>
<div id="method" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Method<a href="kernel-density-estimator.html#method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To detect spatio-temporal clusters of forest fires, we will use the following statistical methods:</p>
<ol style="list-style-type: decimal">
<li><p>The <strong>Ripley’s K- function</strong>, to test the space–time interaction and the spatial attraction/in dependency between fires of different size.</p></li>
<li><p>The <strong>kernel density estimator</strong>, allowing elaborating smoothed density surfaces representing fires over-densities.</p></li>
</ol>
<p>We provide below a short description for both these methods.
More details can be found in <span class="citation">Tonini et al.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></span></p>
<div id="ripleys-k-function" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Ripley’s K-function<a href="kernel-density-estimator.html#ripleys-k-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Ripley’s K-function allows inferring about the spatial randomness of mapped punctual events.
It is largely applied in environmental studies to analyse the pattern distribution of a spatial point process.
The original spatial univariate K-function <span class="math inline">\(K(s)\)</span> is defined as the ratio between the expected number <span class="math inline">\(E\)</span> of point events falling at a certain distance <span class="math inline">\(r\)</span> from an arbitrary event and the intensity <span class="math inline">\(\lambda\)</span> of the spatial point process, this last corresponding to the average number of points per unit area.</p>
<p>Under complete spatial randomness, which assumes the independence among the events, <span class="math inline">\(K(s)\)</span> is equal to the area of the circle around the target event for each distance’s value.
It follows that events are spatially clustered within the range of distances at which <span class="math inline">\(K(s)\)</span> assumes vales higher than this area, while they are spatially dispersed for lower values.
The temporal K-function <span class="math inline">\(K(t)\)</span> is defined in the same way as for the spatial case, with the time-based intensity and the time length replacing the spatial parameters.</p>
<p>The <strong>spatio-temporal K-function,</strong> <span class="math inline">\(K(s,t)\)</span> can be considered as a bivariate function where space and time represent the two variables of the equation.
It is defined as the number of further events occurring within a distance <span class="math inline">\(r\)</span> and time <span class="math inline">\(t\)</span> from an arbitrary event.</p>
<div id="spatio-temporal-interaction" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Spatio-temporal interaction<a href="kernel-density-estimator.html#spatio-temporal-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If there is no space–time interaction, <span class="math inline">\(K(s,t)\)</span> is equal to the product of the purely spatial and purely temporal K-function.
Inversely, if space and time interact generating clusters, the difference between these two values is positive [<span class="math inline">\(D(s,t)=K(s,t)-K(s)*K(t)\)</span>].</p>
<p>Thus, we can use the perspective 3D-plot of the function <span class="math inline">\(D(s,t)\)</span> to obtain a first diagnostic of space–time clustering: positive values indicate an interaction between these two variables at a well-detectable spatio-temporal scale.</p>
</div>
</div>
<div id="kernel-density-estimator-1" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Kernel density estimator<a href="kernel-density-estimator.html#kernel-density-estimator-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Kernel Density Estimator (KDE) is a non-parametric descriptor tool widely applied in GIS-science to elaborate smoothed density surfaces from spatial variables.
A kernel function <span class="math inline">\(K\)</span> allows weighing up the contribution of each event, based on the relative distance of neighbouring to the target.
The parameter <span class="math inline">\(h\)</span>, called bandwidth, controls the smoothness of the estimated kernel density.
Finally, the kernel density function <span class="math inline">\(f_h(x)\)</span> is estimated by summing all the kernel functions <span class="math inline">\(K\)</span> computed at each point location <span class="math inline">\(x\)</span> and dividing the result by the total number of events (<span class="math inline">\(n\)</span>): <span class="math display">\[f_h(x) = \frac{1}{nh}\sum_{i=j}^{n}K(\frac{x-x_i}{h})\]</span></p>
<p>The time extension of the kernel density estimator (<span class="citation">Tomoki Nakaya and Keiji Yano<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></span>) allows to compute the <strong>three-dimensional kernel density estimator</strong> which includes the spatio-temporal dimensions.</p>
<p>In the present case study we apply a quadratic weighting kernel function, which is an approximation to the Gaussian kernel.
Regarding the bandwidth’s value, we prose to consider the results of the spatio-temporal K-function as an indicator.
Indeed, the distance values showing a maximum cluster behavior over the displayed perspective <span class="math inline">\(D(s,t)\)</span> plot can be attributed to the <span class="math inline">\(h\)</span>-value, minimizing the problem of under- or over-smoothing due to an arbitrary choice of the bandwidth.</p>
</div>
</div>
<div id="load-the-libraries-1" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Load the libraries<a href="kernel-density-estimator.html#load-the-libraries-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fist you have to load the following libraries:</p>
<ul>
<li><strong>splancs</strong>: for display and analysis of spatial point pattern data.</li>
<li><strong>sf</strong>: Support for simple features, a standardized way to encode spatial vector data</li>
<li><strong>ggplot2</strong>: A system for ‘declaratively’ creating graphics</li>
<li><strong>sp</strong>: Classes and methods for spatial data</li>
<li><strong>spatstat</strong>: comprehensive open-source toolbox for analyzing Spatial Point Patterns</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="kernel-density-estimator.html#cb65-1" tabindex="-1"></a><span class="fu">library</span>(splancs)</span>
<span id="cb65-2"><a href="kernel-density-estimator.html#cb65-2" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb65-3"><a href="kernel-density-estimator.html#cb65-3" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb65-4"><a href="kernel-density-estimator.html#cb65-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb65-5"><a href="kernel-density-estimator.html#cb65-5" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb65-6"><a href="kernel-density-estimator.html#cb65-6" tabindex="-1"></a></span>
<span id="cb65-7"><a href="kernel-density-estimator.html#cb65-7" tabindex="-1"></a>(<span class="fu">.packages</span>())</span></code></pre></div>
<pre><code>##  [1] &quot;ggplot2&quot;          &quot;sf&quot;               &quot;spatstat&quot;         &quot;spatstat.linnet&quot; 
##  [5] &quot;spatstat.model&quot;   &quot;rpart&quot;            &quot;spatstat.explore&quot; &quot;nlme&quot;            
##  [9] &quot;spatstat.random&quot;  &quot;spatstat.geom&quot;    &quot;spatstat.data&quot;    &quot;splancs&quot;         
## [13] &quot;sp&quot;               &quot;stats&quot;            &quot;graphics&quot;         &quot;grDevices&quot;       
## [17] &quot;utils&quot;            &quot;datasets&quot;         &quot;methods&quot;          &quot;base&quot;</code></pre>
</div>
<div id="import-the-portuguese-forest-fire-dataset-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Import the Portuguese forest fire dataset<a href="kernel-density-estimator.html#import-the-portuguese-forest-fire-dataset-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section you will load the geodata representing the dataset of the Forest Fires (<strong>FF</strong>) occurred in the continental Portuguese area in the period 1990-2013.
You will also load the boundaries of the study area.
You will start by exploring the datasets using mainly visual tools (plotting and histogram).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="kernel-density-estimator.html#cb67-1" tabindex="-1"></a><span class="co"># Import Portugal boundary </span></span>
<span id="cb67-2"><a href="kernel-density-estimator.html#cb67-2" tabindex="-1"></a>Portugal <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/Portugal.shp&quot;</span>) <span class="co"># entire area</span></span>
<span id="cb67-3"><a href="kernel-density-estimator.html#cb67-3" tabindex="-1"></a></span>
<span id="cb67-4"><a href="kernel-density-estimator.html#cb67-4" tabindex="-1"></a>PortN<span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/Porto_North.shp&quot;</span>) <span class="co"># northern area </span></span>
<span id="cb67-5"><a href="kernel-density-estimator.html#cb67-5" tabindex="-1"></a>PortS<span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/Porto_South.shp&quot;</span>) <span class="co"># southern</span></span>
<span id="cb67-6"><a href="kernel-density-estimator.html#cb67-6" tabindex="-1"></a></span>
<span id="cb67-7"><a href="kernel-density-estimator.html#cb67-7" tabindex="-1"></a><span class="co"># Import the forest fires dataset</span></span>
<span id="cb67-8"><a href="kernel-density-estimator.html#cb67-8" tabindex="-1"></a></span>
<span id="cb67-9"><a href="kernel-density-estimator.html#cb67-9" tabindex="-1"></a>FF<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/ForestFires.shp&quot;</span>) <span class="co"># entire area</span></span>
<span id="cb67-10"><a href="kernel-density-estimator.html#cb67-10" tabindex="-1"></a>FFN<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/FF_North.shp&quot;</span>) <span class="co">#entire area</span></span>
<span id="cb67-11"><a href="kernel-density-estimator.html#cb67-11" tabindex="-1"></a>FFS<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/FF_South.shp&quot;</span>) <span class="co"># Northern area</span></span>
<span id="cb67-12"><a href="kernel-density-estimator.html#cb67-12" tabindex="-1"></a></span>
<span id="cb67-13"><a href="kernel-density-estimator.html#cb67-13" tabindex="-1"></a><span class="co"># Import the shapefile of the Tagus river</span></span>
<span id="cb67-14"><a href="kernel-density-estimator.html#cb67-14" tabindex="-1"></a>river<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;data/Lab02/Rio_Tajo.shp&quot;</span>)</span>
<span id="cb67-15"><a href="kernel-density-estimator.html#cb67-15" tabindex="-1"></a></span>
<span id="cb67-16"><a href="kernel-density-estimator.html#cb67-16" tabindex="-1"></a><span class="fu">summary</span>(FF<span class="sc">$</span>Area_ha)<span class="co"># summary statistics</span></span>
<span id="cb67-17"><a href="kernel-density-estimator.html#cb67-17" tabindex="-1"></a><span class="fu">hist</span>(FF<span class="sc">$</span>Area_ha)</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/import-data-1.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="kernel-density-estimator.html#cb68-1" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log10</span>(FF<span class="sc">$</span>Area_ha)) <span class="co"># see the lab GWSS for more details </span></span></code></pre></div>
<p><img src="03-KDE_files/figure-html/import-data-2.png" width="672" /></p>
<p>For a better understanding of the phenomenon, we can group the events according to the size of the burnt area and to their incidence in the northern and in the southern part of continental Portugal.</p>
<div id="ff-subsets-based-on-the-burned-areas-size" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> FF-subsets based on the burned areas’ size<a href="kernel-density-estimator.html#ff-subsets-based-on-the-burned-areas-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Remember that fires of different size can have been induced by different drivers.
Thus, in the following, we will investigate all the global cluster behavior of forest fires in Portugal considering the three subset separately.
As you have seen in the lab GWSS, based on the frequency distribution of the burned areas, the following three classes can be defined:</p>
<p>* Small fires: less than 15 ha</p>
<p>* Medium fires: between 15 ha and 100 ha</p>
<p>* Large fires: bigger than 100 ha</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="kernel-density-estimator.html#cb69-1" tabindex="-1"></a>SF<span class="ot">=</span>(<span class="fu">subset</span>(FF, Area_ha <span class="sc">&lt;=</span><span class="dv">15</span>)) <span class="co">#create a sub-set including only small fires. </span></span>
<span id="cb69-2"><a href="kernel-density-estimator.html#cb69-2" tabindex="-1"></a></span>
<span id="cb69-3"><a href="kernel-density-estimator.html#cb69-3" tabindex="-1"></a><span class="fu">summary</span>(SF)</span></code></pre></div>
<pre><code>##       Year         Area_ha             X                Y         
##  Min.   :1990   Min.   : 5.000   Min.   : 82761   Min.   :  7772  
##  1st Qu.:1997   1st Qu.: 6.624   1st Qu.:182972   1st Qu.:403849  
##  Median :2001   Median : 8.569   Median :213159   Median :472892  
##  Mean   :2002   Mean   : 9.041   Mean   :219789   Mean   :440692  
##  3rd Qu.:2008   3rd Qu.:11.219   3rd Qu.:259054   3rd Qu.:518384  
##  Max.   :2013   Max.   :15.000   Max.   :361492   Max.   :573192  
##           geometry    
##  POINT        :10902  
##  epsg:NA      :    0  
##  +proj=tmer...:    0  
##                       
##                       
## </code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="kernel-density-estimator.html#cb71-1" tabindex="-1"></a><span class="co"># This is to save the plot </span></span>
<span id="cb71-2"><a href="kernel-density-estimator.html#cb71-2" tabindex="-1"></a>pSF <span class="ot">&lt;-</span> <span class="fu">ggplot</span> ()<span class="sc">+</span></span>
<span id="cb71-3"><a href="kernel-density-estimator.html#cb71-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>Portugal)<span class="sc">+</span></span>
<span id="cb71-4"><a href="kernel-density-estimator.html#cb71-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>SF, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)<span class="sc">+</span></span>
<span id="cb71-5"><a href="kernel-density-estimator.html#cb71-5" tabindex="-1"></a> <span class="fu">ggtitle</span>(<span class="st">&quot;Small fires&quot;</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="kernel-density-estimator.html#cb71-6" tabindex="-1"></a> <span class="fu">coord_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="kernel-density-estimator.html#cb72-1" tabindex="-1"></a>MF<span class="ot">=</span>(<span class="fu">subset</span>(FF, Area_ha <span class="sc">&gt;</span><span class="dv">15</span> <span class="sc">&amp;</span> Area_ha <span class="sc">&lt;=</span><span class="dv">100</span>)) <span class="co">#create a sub-set including only medium fires. </span></span>
<span id="cb72-2"><a href="kernel-density-estimator.html#cb72-2" tabindex="-1"></a></span>
<span id="cb72-3"><a href="kernel-density-estimator.html#cb72-3" tabindex="-1"></a><span class="fu">summary</span>(MF)</span></code></pre></div>
<pre><code>##       Year         Area_ha            X                Y         
##  Min.   :1990   Min.   :15.00   Min.   : 82127   Min.   :  7084  
##  1st Qu.:1997   1st Qu.:21.18   1st Qu.:186031   1st Qu.:403864  
##  Median :2001   Median :30.89   Median :219459   Median :468503  
##  Mean   :2002   Mean   :38.55   Mean   :223915   Mean   :439442  
##  3rd Qu.:2007   3rd Qu.:51.06   3rd Qu.:264349   3rd Qu.:518248  
##  Max.   :2013   Max.   :99.98   Max.   :359535   Max.   :572488  
##           geometry    
##  POINT        :12070  
##  epsg:NA      :    0  
##  +proj=tmer...:    0  
##                       
##                       
## </code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="kernel-density-estimator.html#cb74-1" tabindex="-1"></a><span class="co"># This is to save the plot </span></span>
<span id="cb74-2"><a href="kernel-density-estimator.html#cb74-2" tabindex="-1"></a>pMF <span class="ot">&lt;-</span> <span class="fu">ggplot</span> ()<span class="sc">+</span></span>
<span id="cb74-3"><a href="kernel-density-estimator.html#cb74-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>Portugal)<span class="sc">+</span></span>
<span id="cb74-4"><a href="kernel-density-estimator.html#cb74-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>MF, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-5"><a href="kernel-density-estimator.html#cb74-5" tabindex="-1"></a> <span class="fu">ggtitle</span>(<span class="st">&quot;Midium fires&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="kernel-density-estimator.html#cb74-6" tabindex="-1"></a> <span class="fu">coord_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="kernel-density-estimator.html#cb75-1" tabindex="-1"></a>LF<span class="ot">=</span>(<span class="fu">subset</span>(FF, Area_ha <span class="sc">&gt;</span><span class="dv">100</span>)) <span class="co">#create a sub-set including only large fires.</span></span>
<span id="cb75-2"><a href="kernel-density-estimator.html#cb75-2" tabindex="-1"></a></span>
<span id="cb75-3"><a href="kernel-density-estimator.html#cb75-3" tabindex="-1"></a><span class="fu">summary</span> (LF)</span></code></pre></div>
<pre><code>##       Year         Area_ha              X                Y         
##  Min.   :1990   Min.   :  100.0   Min.   : 83472   Min.   :  8840  
##  1st Qu.:1996   1st Qu.:  139.6   1st Qu.:193831   1st Qu.:383164  
##  Median :2002   Median :  220.7   Median :228709   Median :445272  
##  Mean   :2001   Mean   :  548.3   Mean   :229278   Mean   :423441  
##  3rd Qu.:2006   3rd Qu.:  447.9   3rd Qu.:266146   3rd Qu.:500321  
##  Max.   :2013   Max.   :66070.6   Max.   :357933   Max.   :571984  
##           geometry   
##  POINT        :4301  
##  epsg:NA      :   0  
##  +proj=tmer...:   0  
##                      
##                      
## </code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="kernel-density-estimator.html#cb77-1" tabindex="-1"></a><span class="co"># This is to save the plot </span></span>
<span id="cb77-2"><a href="kernel-density-estimator.html#cb77-2" tabindex="-1"></a>pLF <span class="ot">&lt;-</span> <span class="fu">ggplot</span> ()<span class="sc">+</span></span>
<span id="cb77-3"><a href="kernel-density-estimator.html#cb77-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>Portugal)<span class="sc">+</span></span>
<span id="cb77-4"><a href="kernel-density-estimator.html#cb77-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>LF, <span class="at">size=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb77-5"><a href="kernel-density-estimator.html#cb77-5" tabindex="-1"></a> <span class="fu">ggtitle</span>(<span class="st">&quot;Large fires&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-6"><a href="kernel-density-estimator.html#cb77-6" tabindex="-1"></a> <span class="fu">coord_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="kernel-density-estimator.html#cb78-1" tabindex="-1"></a><span class="co"># Arrange the three spatial maps side by side</span></span>
<span id="cb78-2"><a href="kernel-density-estimator.html#cb78-2" tabindex="-1"></a></span>
<span id="cb78-3"><a href="kernel-density-estimator.html#cb78-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;patchwork&#39;</span>, <span class="at">repos =</span> <span class="st">&quot;http://cran.us.r-project.org&quot;</span>) </span></code></pre></div>
<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/hf/q_2qq0tn1dngf4r3nzfhj3xh0000gn/T//Rtmpwf3uEz/downloaded_packages</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="kernel-density-estimator.html#cb80-1" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># Allow to  combine separate ggplots into the same graphic</span></span>
<span id="cb80-2"><a href="kernel-density-estimator.html#cb80-2" tabindex="-1"></a></span>
<span id="cb80-3"><a href="kernel-density-estimator.html#cb80-3" tabindex="-1"></a>pSF<span class="sc">+</span>pMF<span class="sc">+</span>pLF</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/plot-FFsubsets-1.png" width="672" /></p>
</div>
<div id="ff-subsets-based-on-their-geographical-distribution" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> FF-subsets based on their geographical distribution<a href="kernel-density-estimator.html#ff-subsets-based-on-their-geographical-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In continental Portugal, the <strong>northern half</strong> of the country (above the Tagus River) is characterized by the predominance of forest and semi-natural areas, and by the development of the main cities with their sub-urban ares intermingled with wild land, which the Northern area highly prone to forest fires.
On the other hand, the <strong>southern half</strong> of the country is dominated by agricultural areas with mixed and broad-leaved forest concentrated near the south-west coast, which makes this are less affected by forest fires.
For this reason we will consider these two areas separately.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="kernel-density-estimator.html#cb81-1" tabindex="-1"></a><span class="co"># Plot the map with all the objects</span></span>
<span id="cb81-2"><a href="kernel-density-estimator.html#cb81-2" tabindex="-1"></a><span class="fu">ggplot</span> ()<span class="sc">+</span></span>
<span id="cb81-3"><a href="kernel-density-estimator.html#cb81-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>Portugal)<span class="sc">+</span></span>
<span id="cb81-4"><a href="kernel-density-estimator.html#cb81-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>river, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb81-5"><a href="kernel-density-estimator.html#cb81-5" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>FFN, <span class="at">size=</span><span class="fl">0.3</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="kernel-density-estimator.html#cb81-6" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>FFS, <span class="at">size=</span><span class="fl">0.3</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-7"><a href="kernel-density-estimator.html#cb81-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Forest foirest in the northern and souther area&quot;</span>) <span class="sc">+</span></span>
<span id="cb81-8"><a href="kernel-density-estimator.html#cb81-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb81-9"><a href="kernel-density-estimator.html#cb81-9" tabindex="-1"></a> <span class="fu">coord_sf</span>()</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/import-NS-FF-1.png" width="672" /></p>
</div>
</div>
<div id="the-space-time-k-function" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> The space-time K-function<a href="kernel-density-estimator.html#the-space-time-k-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="extract-time-and-pts-object" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Extract Time and PTS object<a href="kernel-density-estimator.html#extract-time-and-pts-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <strong>stkhat,</strong> included in the library <em>spancs</em>, allows to compute the space-time K-function.
As you can see from the R Documentation (command: <em>help(stkhat)</em>), same data manipulations are necessary to transform the input data in a compatible data frame format.</p>
<p>Namely the user needs to specify:</p>
<ul>
<li><p><em>pts</em>: the input forest fires dataset, with the coordinates to geolocalize each event.</p></li>
<li><p><em>times</em>: a vector of times, defined by the starting date of ignition.</p></li>
<li><p><em>poly</em>: a polygon of class matrix enclosing the input dataset (<em>pts)</em></p></li>
<li><p><em>s</em> and <em>tm</em>: a vector of spatial (<em>s</em>) and a vector of temporal (<em>tm</em>) distances for the analysis.</p></li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="kernel-density-estimator.html#cb82-1" tabindex="-1"></a><span class="co"># Extract &quot;pts&quot; (divided by 1000 to compute in Km)</span></span>
<span id="cb82-2"><a href="kernel-density-estimator.html#cb82-2" tabindex="-1"></a>FFN_pts<span class="ot">&lt;-</span><span class="fu">as.points</span>(FFN<span class="sc">$</span>X<span class="sc">/</span><span class="dv">1000</span>,FFN<span class="sc">$</span>Y<span class="sc">/</span><span class="dv">1000</span>) </span>
<span id="cb82-3"><a href="kernel-density-estimator.html#cb82-3" tabindex="-1"></a>FFN_times<span class="ot">&lt;-</span>FFN<span class="sc">$</span>Year <span class="co"># extract &quot;times&quot;</span></span>
<span id="cb82-4"><a href="kernel-density-estimator.html#cb82-4" tabindex="-1"></a></span>
<span id="cb82-5"><a href="kernel-density-estimator.html#cb82-5" tabindex="-1"></a><span class="co"># Extract the coordinates (in Km):</span></span>
<span id="cb82-6"><a href="kernel-density-estimator.html#cb82-6" tabindex="-1"></a>PTN_xy<span class="ot">&lt;-</span><span class="fu">st_coordinates</span>(PortN<span class="sc">$</span>geometry<span class="sc">/</span><span class="dv">1000</span>) </span>
<span id="cb82-7"><a href="kernel-density-estimator.html#cb82-7" tabindex="-1"></a></span>
<span id="cb82-8"><a href="kernel-density-estimator.html#cb82-8" tabindex="-1"></a><span class="co"># Define the matrix with the set of bounding points (&quot;poly&quot;) enclosing the input dataset:</span></span>
<span id="cb82-9"><a href="kernel-density-estimator.html#cb82-9" tabindex="-1"></a>FFN_poly<span class="ot">&lt;-</span>PTN_xy[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)] </span></code></pre></div>
</div>
<div id="compute-the-space-time-k-function" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Compute the space-time K-function<a href="kernel-density-estimator.html#compute-the-space-time-k-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Compute the space-time K-function for forest fires in the northern area.
Since the computation can take a long time (about 20 mints), we propose you to load directly the output R object provided (<em>STK_North_10y</em>).
The general code is also provided, but preceded by the hashtag, so it is not treated as a command: you have to remove # if you wish to evaluate the code.</p>
<ul>
<li><p>We consider here a <em>subset</em> of forest fires event occurred in the period 2001-2010.</p></li>
<li><p>The parameters <em>s</em> and <em>t</em> are defined here as follows: (<em>s</em>) each kilometer distance up to ten kilometers; (<em>tm</em>) each year up to five years.</p></li>
</ul>
<p><strong>NB</strong>: If you wish to run the code, remove # to make it work</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="kernel-density-estimator.html#cb83-1" tabindex="-1"></a><span class="co"># Open stkhat documentation</span></span>
<span id="cb83-2"><a href="kernel-density-estimator.html#cb83-2" tabindex="-1"></a><span class="fu">help</span>(stkhat)</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="kernel-density-estimator.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb84-2"><a href="kernel-density-estimator.html#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="kernel-density-estimator.html#cb84-3" tabindex="-1"></a>STK_North_10y <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/Lab02/STK_North_10y.RData&quot;</span>)</span>
<span id="cb84-4"><a href="kernel-density-estimator.html#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="kernel-density-estimator.html#cb84-5" tabindex="-1"></a><span class="fu">str</span>(STK_North_10y)</span></code></pre></div>
<pre><code>## List of 5
##  $ s  : num [1:11] 0 1 2 3 4 5 6 7 8 9 ...
##  $ t  : num [1:6] 0 1 2 3 4 5
##  $ ks : num [1:11] 1.61e-04 9.03 2.98e+01 6.18e+01 1.05e+02 ...
##  $ kt : num [1:6] 0.814 2.29 3.596 4.827 6.085 ...
##  $ kst: num [1:11, 1:6] 1.45e-03 1.06e+01 3.75e+01 7.47e+01 1.22e+02 ...</code></pre>
</div>
<div id="assess-the-space-time-clustering-behavior" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Assess the space-time clustering behavior<a href="kernel-density-estimator.html#assess-the-space-time-clustering-behavior" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the following section you will explore and plot the values of the three components produced as outputs of the function <em>stkhat</em>: the spatial K-function (ks), the temporal K-function (kt); the space-time K-function (kst).</p>
<p>Finally you will plot the perspective 3D-plot of <span class="math inline">\(D(s,t)\)</span> to evaluate the space–time clustering behavior of forest fires in the present case study.
The multifaceted shape of this function, along the spatial and the temporal dimension, can help to identify peaks of clustering.
Finally, the corresponding values can be attributed to the bandwidth of the kernel density estimators allowing to elaborate smoothed density maps in the last step of this lab.</p>
<div id="plot-the-stkhat-outputs" class="section level4 hasAnchor" number="3.5.3.1">
<h4><span class="header-section-number">3.5.3.1</span> Plot the <em>stkhat</em> outputs<a href="kernel-density-estimator.html#plot-the-stkhat-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Plot of the purely spatial and the purely temporal K function.</strong></li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="kernel-density-estimator.html#cb86-1" tabindex="-1"></a><span class="co"># Plot of the purely spatial K function</span></span>
<span id="cb86-2"><a href="kernel-density-estimator.html#cb86-2" tabindex="-1"></a><span class="fu">plot</span>(STK_North_10y<span class="sc">$</span>s, STK_North_10y<span class="sc">$</span>ks, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;distance&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Estimated Ks&quot;</span>, <span class="at">main=</span><span class="st">&quot;Spatial K function&quot;</span>)</span>
<span id="cb86-3"><a href="kernel-density-estimator.html#cb86-3" tabindex="-1"></a><span class="fu">lines</span>(STK_North_10y<span class="sc">$</span>s, pi<span class="sc">*</span>STK_North_10y<span class="sc">$</span>s<span class="sc">^</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/plot-stk-1.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="kernel-density-estimator.html#cb87-1" tabindex="-1"></a><span class="co"># Plot of the purely temporal K-function</span></span>
<span id="cb87-2"><a href="kernel-density-estimator.html#cb87-2" tabindex="-1"></a><span class="fu">plot</span>(STK_North_10y<span class="sc">$</span>t, STK_North_10y<span class="sc">$</span>kt, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Estimated Kt&quot;</span>, <span class="at">main=</span><span class="st">&quot;Temporal K function&quot;</span>)</span>
<span id="cb87-3"><a href="kernel-density-estimator.html#cb87-3" tabindex="-1"></a><span class="fu">lines</span>(STK_North_10y<span class="sc">$</span>t, <span class="dv">2</span><span class="sc">*</span>STK_North_10y<span class="sc">$</span>t, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/plot-stk-2.png" width="672" /></p>
<ul>
<li><strong>Plot the space-time D-plot</strong></li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="kernel-density-estimator.html#cb88-1" tabindex="-1"></a><span class="co"># Define the function: D(s,t)=K(s,t)-[K(s)*K(t)]</span></span>
<span id="cb88-2"><a href="kernel-density-estimator.html#cb88-2" tabindex="-1"></a></span>
<span id="cb88-3"><a href="kernel-density-estimator.html#cb88-3" tabindex="-1"></a>Dplot <span class="ot">&lt;-</span> <span class="cf">function</span> (stkhat, <span class="at">Dzero =</span> <span class="cn">FALSE</span>, <span class="at">main=</span><span class="cn">TRUE</span>)  {</span>
<span id="cb88-4"><a href="kernel-density-estimator.html#cb88-4" tabindex="-1"></a></span>
<span id="cb88-5"><a href="kernel-density-estimator.html#cb88-5" tabindex="-1"></a>  oprod <span class="ot">&lt;-</span> <span class="fu">outer</span>(stkhat<span class="sc">$</span>ks, stkhat<span class="sc">$</span>kt)</span>
<span id="cb88-6"><a href="kernel-density-estimator.html#cb88-6" tabindex="-1"></a>    st.D <span class="ot">&lt;-</span> stkhat<span class="sc">$</span>kst <span class="sc">-</span> oprod</span>
<span id="cb88-7"><a href="kernel-density-estimator.html#cb88-7" tabindex="-1"></a>        <span class="fu">persp</span>(stkhat<span class="sc">$</span>s, stkhat<span class="sc">$</span>t, st.D, <span class="at">xlab =</span> <span class="st">&quot;Distance (Km)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Time (years)&quot;</span>,</span>
<span id="cb88-8"><a href="kernel-density-estimator.html#cb88-8" tabindex="-1"></a>            <span class="at">zlab =</span> <span class="st">&quot;D(s,t)&quot;</span>, <span class="at">expand =</span> <span class="fl">0.5</span>, <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>,</span>
<span id="cb88-9"><a href="kernel-density-estimator.html#cb88-9" tabindex="-1"></a>            <span class="at">theta =</span> <span class="sc">-</span><span class="dv">45</span>, <span class="at">shade =</span> <span class="fl">0.75</span>, <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">ltheta=</span><span class="dv">120</span>, <span class="at">col=</span><span class="st">&quot;cyan1&quot;</span>, <span class="at">font.lab=</span><span class="dv">2</span>)</span>
<span id="cb88-10"><a href="kernel-density-estimator.html#cb88-10" tabindex="-1"></a>           }</span>
<span id="cb88-11"><a href="kernel-density-estimator.html#cb88-11" tabindex="-1"></a></span>
<span id="cb88-12"><a href="kernel-density-estimator.html#cb88-12" tabindex="-1"></a><span class="fu">Dplot</span>(STK_North_10y)</span>
<span id="cb88-13"><a href="kernel-density-estimator.html#cb88-13" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Dplot Nothern Fires&quot;</span>)</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/Dplot-1.png" width="672" /></p>
</div>
<div id="run-the-space-time-kernel-density-estimator" class="section level4 hasAnchor" number="3.5.3.2">
<h4><span class="header-section-number">3.5.3.2</span> Run the space-time kernel density estimator<a href="kernel-density-estimator.html#run-the-space-time-kernel-density-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The multifaceted shape the D-Plot identify peaks of clustering a time value of 3 year.
In spece, events are clustered and every distance, so in this case we use the maximum values (10 km).
these two values are attributed to the bandwidth of the kernel density estimators allowing to elaborate smoothed density maps.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="kernel-density-estimator.html#cb89-1" tabindex="-1"></a><span class="co"># Open the help to analyse the parameter of this kernel function: </span></span>
<span id="cb89-2"><a href="kernel-density-estimator.html#cb89-2" tabindex="-1"></a><span class="fu">help</span>(kernel3d)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="kernel-density-estimator.html#cb90-1" tabindex="-1"></a><span class="co"># Run the function</span></span>
<span id="cb90-2"><a href="kernel-density-estimator.html#cb90-2" tabindex="-1"></a>KDE_FFN<span class="ot">&lt;-</span><span class="fu">kernel3d</span>(FFN_pts, FFN_times, <span class="fu">seq</span>(<span class="dv">80</span>, <span class="dv">362</span>, <span class="dv">1</span>), <span class="fu">seq</span>(<span class="dv">180</span>, <span class="dv">580</span>, <span class="dv">1</span>), <span class="fu">seq</span>(<span class="dv">1990</span>,<span class="dv">2013</span>,<span class="dv">1</span>), <span class="dv">10</span>, <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="kernel-density-estimator.html#cb91-1" tabindex="-1"></a><span class="fu">summary</span>(KDE_FFN<span class="sc">$</span>v)</span>
<span id="cb91-2"><a href="kernel-density-estimator.html#cb91-2" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log10</span>(KDE_FFN<span class="sc">$</span>v))</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/hist-KDE-1.png" width="672" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="kernel-density-estimator.html#cb92-1" tabindex="-1"></a><span class="fu">min</span>(KDE_FFN<span class="sc">$</span>v[KDE_FFN<span class="sc">$</span>v<span class="sc">&gt;</span><span class="dv">0</span>]) <span class="co">#check the lower non-zero value </span></span></code></pre></div>
<pre><code>## [1] 2.893333e-12</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="kernel-density-estimator.html#cb94-1" tabindex="-1"></a><span class="co"># Create quantile clssification </span></span>
<span id="cb94-2"><a href="kernel-density-estimator.html#cb94-2" tabindex="-1"></a>Q<span class="ot">&lt;-</span><span class="fu">quantile</span>(KDE_FFN<span class="sc">$</span>v, <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb94-3"><a href="kernel-density-estimator.html#cb94-3" tabindex="-1"></a>Q</span></code></pre></div>
<pre><code>##          50%          55%          60%          65%          70%          75% 
## 0.0002194741 0.0097073381 0.0263666531 0.0478856382 0.0748979448 0.1093260662 
##          80%          85%          90%          95%         100% 
## 0.1560709189 0.2210177893 0.3232627322 0.5162620818 2.1627084390</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="kernel-density-estimator.html#cb96-1" tabindex="-1"></a><span class="co"># Create a blue/red palette</span></span>
<span id="cb96-2"><a href="kernel-density-estimator.html#cb96-2" tabindex="-1"></a>pal<span class="ot">&lt;-</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;red&quot;</span> ))</span>
<span id="cb96-3"><a href="kernel-density-estimator.html#cb96-3" tabindex="-1"></a>colsR<span class="ot">&lt;-</span><span class="fu">pal</span>(<span class="fu">length</span>(Q)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb96-4"><a href="kernel-density-estimator.html#cb96-4" tabindex="-1"></a></span>
<span id="cb96-5"><a href="kernel-density-estimator.html#cb96-5" tabindex="-1"></a><span class="co"># Display classes</span></span>
<span id="cb96-6"><a href="kernel-density-estimator.html#cb96-6" tabindex="-1"></a><span class="fu">pie</span>(Q, <span class="at">clockwise=</span><span class="cn">TRUE</span>, <span class="at">labels=</span><span class="fu">round</span>(Q, <span class="at">digits=</span><span class="dv">2</span>), <span class="at">border=</span><span class="st">&quot;white&quot;</span>, <span class="at">col=</span>colsR)</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/plot-KDE-1.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="kernel-density-estimator.html#cb97-1" tabindex="-1"></a><span class="co"># Plot KDE maps for selected years</span></span>
<span id="cb97-2"><a href="kernel-density-estimator.html#cb97-2" tabindex="-1"></a>oldpar<span class="ot">&lt;-</span><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb97-3"><a href="kernel-density-estimator.html#cb97-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>){</span>
<span id="cb97-4"><a href="kernel-density-estimator.html#cb97-4" tabindex="-1"></a> (<span class="fu">image</span>(<span class="fu">seq</span>(<span class="dv">80</span>, <span class="dv">362</span>, <span class="dv">1</span>), <span class="fu">seq</span>(<span class="dv">180</span>, <span class="dv">580</span>, <span class="dv">1</span>), KDE_FFN<span class="sc">$</span>v[,,i], <span class="at">asp=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">main=</span><span class="dv">1989</span><span class="sc">+</span>i, <span class="at">breaks=</span>Q, <span class="at">col=</span>colsR))</span>
<span id="cb97-5"><a href="kernel-density-estimator.html#cb97-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-KDE_files/figure-html/plot-KDE-2.png" width="672" /></p>
</div>
</div>
</div>
<div id="conclusions-and-further-analyses-1" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Conclusions and further analyses<a href="kernel-density-estimator.html#conclusions-and-further-analyses-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This practical computer lab allowed you to familiarize with the assement of the global cluster behavior of hazardous events, achieved by using the Ripley’s k-function.
In addition, we learned how smoothed density maps can be elaborated from punctual events, namely using the kernel density estimator.
Both spatial and the temporal dimension have been considered in this case.</p>
<p>This method allowed us to explore density distribution of forest fires events through Continental Portugal in the period 1990-2013.
In the northern half of the country, hot spots are present almost on each investigated years, with a higher concentration in the northern areas.</p>
<p>To be sure that everything is perfectly clear for you, we propose you to do this lab again, by using this time another subset chosen among the forest fires in the Southern area, the small, medium or the large forest fires dataset.</p>
<p>For whatever dataset you are going to use, try to answer to the following questions.
The reading of the paper <span class="citation">Tonini et al.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></span>, which inspired this lab, can help you in in this task.</p>
<ol style="list-style-type: decimal">
<li><p>At which spatial and temporal distance you can observe a peak of clustering?</p></li>
<li><p>Describe which is spatio-temporal density distribution of forest fires events through the study area.</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-nakaya_visualising_2010" class="csl-entry">
Nakaya, Tomoki, and Keiji Yano. <span>“Visualising Crime Clusters in a Space-Time Cube: An Exploratory Data-Analysis Approach Using Space-Time Kernel Density Estimation and Scan Statistics.”</span> <em>Transactions in <span>GIS</span></em> 14, no. 3 (2010): 223–39. <a href="https://doi.org/10.1111/j.1467-9671.2010.01194.x">https://doi.org/10.1111/j.1467-9671.2010.01194.x</a>.
</div>
<div id="ref-tonini_evolution_2017" class="csl-entry">
Tonini, Marj, Mário Gonzalez Pereira, Joana Parente, and Carmen Vega Orozco. <span>“Evolution of Forest Fires in Portugal: From Spatio-Temporal Point Events to Smoothed Density Maps.”</span> <em>Natural Hazards</em> 85, no. 3 (February 1, 2017): 1489–1510. <a href="https://doi.org/10.1007/s11069-016-2637-x">https://doi.org/10.1007/s11069-016-2637-x</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p><a href="#ref-tonini_evolution_2017"><span>“Evolution of Forest Fires in Portugal”</span></a>.<a href="kernel-density-estimator.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><a href="#ref-nakaya_visualising_2010"><span>“Visualising Crime Clusters in a Space-Time Cube: An Exploratory Data-Analysis Approach Using Space-Time Kernel Density Estimation and Scan Statistics,”</span> <em>Transactions in <span>GIS</span></em> 14, no. 3 (2010): 223–39, <span>https://doi.org/10.1111/j.1467-9671.2010.01194.x</span></a>.<a href="kernel-density-estimator.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p><a href="#ref-tonini_evolution_2017"><span>“Evolution of Forest Fires in Portugal”</span></a>.<a href="kernel-density-estimator.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="geographically-weighted-summary-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="density-based-clustering-algorithm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-KDE.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fake-book.pdf", "fake-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
